<!DOCTYPE html lang="en">
<head>
    <title>JB's Simple Flyers</title>
    <link rel="stylesheet" href="pages/styles/editorStyle.css"/>
    <link rel="stylesheet" href="pages/styles/flyerStyles.css"/>
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
    <script src="scripts/pdfScripts.js"></script>
    <script src="scripts/is.js-master/is.min.js"></script>
</head>
<body>
    <div id="browserWarning" class="hidden">
        <p>This application is only supported on the Google Chrome browser. Please switch to ensure you get the best results.</p>
    </div>
    <div id="grid">
        <div id="pdfViewer">
            <div id="pageContainer">
                <div class="page">
                    <!-- PDF PAGE 1 -->
                    <!--Background: -->
                    <img class="pageBG" src="resources/images/AutoFly BG.png"/>

                    <!-- Flyer Title -->
                    <div id="headerContainer" class="flyerComponent"> 
                        <p id="flyerHeader" class="centered headerText">Flyer Title</p>
                    </div>

                    <!-- Stock image: -->
                    <div id="stockImageContainer" class="flyerComponent">
                        <img id="stockImage" src="resources/images/stockImages/business.jpg">
                    </div>
                    
                    <!-- RTO Text and Images: -->
                    <p id="tagLogoText" class="flyerComponent">POWERED BY</p>
                    <p id="rtoLogoText" class="flyerComponent">DELIVERED BY</p>
                    <img id="tagLogo" class="flyerComponent" src="resources/images/RTOs/Training Alliance.png"/>

                    <img id="ABVLogo" class="flyerComponent hidden" src="resources/images/RTOs/ABV.png"/>
                    <img id="MTACSLogo" class="flyerComponent hidden" src="resources/images/RTOs/MTACS - large.png" />
                    <img id="SSTLogo" class="flyerComponent hidden" src="resources/images/RTOs/Stirling Skills Training Logo.png"/>

                    <!--Contact Us: -->
                    <div id="contactUs" class="flyerComponent">
                        <p id="contactUsHeader">Contact Us</p>
                        <p id="contactName">Kevin Kelly</p>
                        <p id="contactEmail">kkelly@trainingalliance.com.au</p>
                        <p id="contactNumber">0428 939 663</p>
                    </div>

                    <!-- Course Details: -->
                    <div id="detailsDivider" class="flyerComponent">
                        <p class="centered detailsHeader">Course Start</p>
                        <p class="centered detailsHeader">Duration</p>
                        <p class="centered detailsHeader">Location</p>
                        <div>
                            <p id="startDate" class="centered">1st of January, 2020</p>
                            <p id="startDateSubtext" class="centered">9am - 4pm</p>
                        </div>
                        <div>
                            <p id="duration" class="centered">12 weeks</p>
                            <p id="durationSubtext" class="centered">Classroom and practical training</p>
                        </div>
                        <div>
                            <p id="location" class="centered">Level 1, 14 Ventnor Ave</p>
                            <p id="locationSubtext" class="centered"></p>
                        </div>
                    </div>

                    <!-- Course information -->
                    <div id="infoDivider" class="flyerComponent">
                        <div id="jobRolesContainer">
                            <p id="jobRolesHeader">Typical Job Roles:</p>
                            <ul id="jobRoleList">
                                <li>Job Role 1</li>
                                <li>Job Role 2</li>
                                <li>Job Role 3</li>
                                <li>Job Role 4</li>
                            </ul>
                        </div>
                        <p id="infoText">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam blandit commodo velit, at lobortis magna mollis et. Donec finibus posuere quam, et porta lacus porttitor sed. Suspendisse convallis, nisi non dictum mollis, leo ante vestibulum tellus, eleifend interdum tortor nibh vel nisi. Vestibulum sed porta nisi. Mauris at molestie neque, eget ullamcorper nibh. Nam lobortis tincidunt imperdiet. Proin non ipsum est.</p>
                    </div>

                    <!-- Compliance Images -->
                    <div id="complianceImagesContainer" class="flyerComponent">
                        <img id="jobSkillsLogo" src="resources/images/complianceImages/jswa_primary_logo.jpg"/>
                        <img id="skillsReadyLogo" src="resources/images/complianceImages/jswa_skillsready_txt.jpg"/>
                        <img id="LFLSLogo" src="resources/images/complianceImages/LFLS_small.jpg"/>
                        <img id="NRTLogo" src="resources/images/complianceImages/nationally recognised training logo.png"/>
                    </div>

                    <!-- RTO Information -->
                    <div id="RTOInfo" class="flyerComponent">
                        <p>RTO NAME</p>
                        <p>RTO NUMBER</p>
                        <p>RTO ABN</p>
                        <p>RTO TELEPHONE</p>
                    </div>
                </div>
                <div class="page">
                    <!-- PDF PAGE 2 -->
                    <!-- Background: -->
                    <img class="pageBG" src="resources/images/AutoFly BG 2.png"/>

                    <!-- Flyer Title and website link -->
                    <p id="secondaryFlyerHeader" class="flyerComponent centered headerText">Flyer Title</p>
                    <p id="websiteLink" class="flyerComponent headerText">www.trainingalliance.com.au</p>

                    <!-- Unit Table and RTO logo -->
                    <table id="unitTable" class="flyerComponent table">
                        <tr>
                            <th style="width: 26%;">Unit Code</th>
                            <th>Unit Title</th>
                        </tr>
                    </table>
                    <!--
                        <img id="ABVLogo2" class="flyerComponent hidden" src="../resources/images/RTOs/ABV.png"/>
                        <img id="MTACSLogo2" class="flyerComponent hidden" src="../resources/images/RTOs/MTACS - large.png"/>
                        <img id="SSTLogo2" class="flyerComponent hidden" src="../resources/images/RTOs/Stirling Skills Training Logo.png"/>
                    -->

                    <!-- Compliance info -->
                    <div id="complianceInfo" class="flyerComponent">
                        <div>
                            <p id="otherInfoHeader" class="infoHeader">Other Information and Assessment Methods:</p>
                            <p id="otherInfoContent" class="infoContent"></p>
                        </div>

                        <div>
                            <p id="preReqsHeader" class="infoHeader">Pre-requisites:</p>
                            <p id="preReqsContent" class="infoContent"></p>
                        </div>
                        <div>
                            <p id="eligibilityCriteriaHeader" class="infoHeader">Eligibility Criteria - Work Readiness Program:</p>
                            <p id="eligibilityCriteriaContent" class="infoContent"></p>
                        </div>
                        <!-- Pricing Info -->
                        <div id="pricingContainer">
                            <div id="prices">
                                <p id="pricingHeader" class="infoHeader">Student Tutition Fees</p>
                                <div id="pricesContainer">
                                    <p id="concessionPriceText">Concession:</p>
                                    <p id="concessionPrice">$ 370.56</p>
                                    <p id="priceText">Non-concession:</p>
                                    <p id="price">$ 1,250.64</p>
                                </div>
                            </div>
                            <p id="pricingInfoText" class="infoContent">
  
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="sidebar">
            <div id="sectionContainer">
                <div class="section" onchange="checkScrollHeight.call(this);">
                    <div class="heading">
                        <h2>RTO & Course</h2>
                    </div>
                    <div class="dropper">
                        <img class="dropperImage" src="resources/images/down_arrow.png"/>
                    </div>
                    <div class="content">
                        <div id="sidebarInputsRTO" class="logoSelector" onchange="RTOSelect()">

                            <input type="radio" id="abv" name="RTOSelect" required="">
                            <label for="abv"><img src="resources/images/RTOs/ABV.png"/></label>

                            <input type="radio" id="mtacs" name="RTOSelect" required="">
                            <label for="mtacs"><img src="resources/images/RTOs/MTACS - large.png" style="padding: 20% 0;"/></label>

                            <input type="radio" id="sst" name="RTOSelect" required="">
                            <label for="sst"><img src="resources/images/RTOs/Stirling Skills Training Logo.png"/></label>
                        </div>
                        <div id="courseSelector" onchange="courseSelect()" class="pure-form">
                            <h3>Course:</h3>
                            <select id="abvCourses" class="hidden" name="abvCourses" >
                                <option value="">Choose a course...</option>
                                <option value="CPC20211">CPC2011 - Cert II in Construction Pathways</option>
                                <option value="BSB30115">BSB30115 - Cert III in Business</option>
                                <option value="RII30815">RII30815 - Cert III in Civil Construction Plant Operations</option>
                                <option value="RII30115">RII30115 - Cert III in Surface Extraction Operations</option>
                                <option value="TLI30319">TLI30319 - Cert III in Supply Chain Operations</option>
                                <option value="TLI31616">TLI31616 - Cert III in Warehousing Operations</option>
                            </select>
                            <select id="mtacsCourses" class="hidden" name="mtacsCourses">
                                <option value="">Choose a course...</option>
                                <option value="CPC20211">CPC2011 - Cert II in Construction Pathways</option>
                                <option value="RII30815">RII30815 - Cert III in Civil Construction Plant Operations</option>
                                <option value="RII30115">RII30115 - Cert III in Surface Extraction Operations</option>
                                <option value="TLI20119">TLI20119 - Cert II in Logistics</option>
                                <option value="TLI20419">TLI20419 - Cert II in Warehousing Operations</option>
                            </select>
                            <select id="sstCourses" class="hidden" name="sstCourses">
                                <option value="">Choose a course...</option>
                                <option value="TLI31616">TLI31616 - Cert III in Warehousing Operations</option>
                                <option value="TLI20419">TLI20419 - Cert II in Warehousing Operations</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="section" onchange="checkScrollHeight.call(this);">
                    <div class="heading">
                        <h2>General Info</h2>
                    </div>
                    <div class="dropper">
                        <img class="dropperImage" src="resources/images/down_arrow.png"/>
                    </div>
                    <div class="content" class="collapsed">
                        <div id="courseDetailsContainer" class="pure-form">
                            <fieldset class="pure-group">
                                <h3>Date:</h3>
                                <input id="dateTextInput" type='text' placeholder="Main text" onchange="detailsChange(this, 'courseStart')" required=""/>
                                <input id="dateSubTextInput" type='text' placeholder="Subtext" onchange="detailsChange(this, 'courseStartSubtext')"/>
                            </fieldset>
                            
                            <fieldset class="pure-group">
                                <h3>Duration:</h3>
                                <input id="durationTextInput" type='text' placeholder="Main text" onchange="detailsChange(this, 'duration')" required=""/>
                                <input id="durationSubTextInput" type='text' placeholder="Subtext" onchange="detailsChange(this, 'durationSubtext')"/>    
                            </fieldset>

                            <fieldset class="pure-group">
                                <h3>Location:</h3>
                                <input id="locationTextInput" type='text' placeholder="Main text" onchange="detailsChange(this, 'location')" required=""/>
                                <input id="locationSubTextInput" type='text' placeholder="Subtext" onchange="detailsChange(this, 'locationSubtext')"/>    
                            </fieldset>

                            <fieldset class="pure-group">
                                <h3>Fees:</h3>
                                <input id="concessionFeeInput" type='text' placeholder="Concession fee" onchange="detailsChange(this, 'concessionFee')" required=""/>
                                <input id="feeInput" type='text' placeholder="Normal fee" onchange="detailsChange(this, 'normalFee')" required=""/>
                                <br>
                                <sub>Include commas and fullstops where needed. (E.g. 1,400 & 2,765.56)</sub>
                            </fieldset>

                        </div>
                    </div>
                </div>
                <div class="section" onchange="checkScrollHeight.call(this);">
                    <div class="heading">
                        <h2>Units</h2>
                    </div>
                    <div class="dropper">
                        <img class="dropperImage" src="resources/images/down_arrow.png"/>
                    </div>
                    <div class="content">
                        <div id="unitSelector" onchange="unitSelect()">
                            <table id="unitSelectorTable" class="table pure-form">
                                <tr>
                                    <th></th>
                                    <th>Unit Code</th>
                                    <th>Unit Title</th>
                                </tr>
                            </table>
                        </div> 
                    </div>
                </div>
                <div class="section" onchange="checkScrollHeight.call(this);">
                    <div class="heading">
                        <h2>Contact</h2>
                    </div>
                    <div class="dropper">
                        <img class="dropperImage" src="resources/images/down_arrow.png"/>
                    </div>
                    <div class="content">
                        <div id="contactSelector" onchange="contactSelect()" class="pure-form">
                            <label for="contactCardCustom" class="contactCard">
                                <input id="contactCardCustom" name="contacts" type="radio"/>
                                <div class="pure-form">
                                    <fieldset style="padding-right: 15px;">
                                        <h4>Custom contact</h4>
                                        <input id="customContactName" type="text" placeholder="John Smith"/>
                                        <input id="customContactEmail" type="text" placeholder="jsmith@trainingalliance.com.au"/>
                                        <input id="customContactNumber" type="text" placeholder="0468 939 484"/>
                                    </fieldset>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="section" onchange="checkScrollHeight.call(this);">
                    <div class="heading">
                        <h2>Third-party Logos</h2>
                    </div>
                    <div class="dropper">
                        <img class="dropperImage" src="resources/images/down_arrow.png"/>
                    </div>
                    <div class="content">
                        <div id="complianceLogoSelector" class="logoSelector" onchange="complianceLogoSelect()" class="fure-form">
                            <input type="checkbox" id="jobsAndSkillsSelector" name="complianceSelect" checked="true"/>
                            <label for="jobsAndSkillsSelector"><img id="jobsAndSkillsLogoSelector" src="resources/images/complianceImages/jswa_primary_logo.jpg"></label>

                            <input type="checkbox" id="skillsReadySelector" name="complianceSelect" checked="true"/>
                            <label for="skillsReadySelector"><img id="skillsReadyLogoSelector" src="resources/images/complianceImages/jswa_skillsready_txt.jpg"></label>

                            <input type="checkbox" id="LFLSSelector" name="complianceSelect"/ checked="true">
                            <label for="LFLSSelector"><img id="LFLSLogoSelector" src="resources/images/complianceImages/LFLS_small.jpg"></label>

                            <input type="checkbox" id="NRTSelector" name="complianceSelect" checked="true"/>
                            <label for="NRTSelector"><img id="NRTLogoSelector" src="resources/images/complianceImages/nationally recognised training logo.png"></label>
                        </div>
                    </div>
                </div>
                <div class="section" onchange="checkScrollHeight.call(this)">
                    <div class="heading">
                        <h2>Compliance</h2>
                    </div>
                    <div class="dropper">
                        <img class="dropperImage" src="resources/images/down_arrow.png"/>
                    </div>
                    <div class="content" class="collapsed">
                        <div id="complianceContainer" class="pure-form" onchange="complianceInfoSelect()">
                            <fieldset>
                                <h3>Other Information and Assessment Methods</h3>
                                <input id="practicalTrainingLocation" type="checkbox" name="otherInfo"/><label for="practicalTrainingLocation">Practical training at different location.</label>
                                <br>
                                <input id="LLNStatement" type="checkbox" checked="true" name="otherInfo"/><label for="LLNStatement">All candidates must complete LLN.</label>
                                <br>
                                <input id="studentAgreement" type="checkbox" checked="true" name="otherInfo"/><label for="studentAgreement">Student agreement.</label>
                                <br>
                                <input id="assessment" type="checkbox" checked="true" name="otherInfo"><label for="assessment">Assessment.</label>
                                <br>
                                <input id="usi" type="checkbox" checked="true" name="otherInfo"><label for="usi">USI required.</label>
                                <br>
                                <input id="completionDocs" type="checkbox" checked="true" name="otherInfo"><label for="completionDocs">Completion docs.</label>
                            </fieldset>
                            <fieldset>
                                <h3>Pre-requisites</h3>
                                <input id="adultCheck" type="checkbox" name="preReqs"><label for="adultCheck">Students must be 18+ years.</label>
                                <br>
                                <input id="notAdult" type="checkbox" name="preReqs"><label for="notAdult">Under 18's will have different units.</label>
                            </fieldset>
                            <fieldset>
                                <h3>Eligibility Criteria</h3>
                                <input id="employmentStatus" type="checkbox" name="eligibilityCriteria"/><label for="employmentStatus">Clients must be un-employed or under employed.</label>
                                <br>
                                <input id="citizenVisa" type="checkbox" name="eligibilityCriteria"/><label for="citizenVisa">Must be Citizen or hold specific visa.</label>
                                <br>
                                <input id="schoolieCheck" type="checkbox" name="eligibilityCriteria"/><label for="schoolieCheck">School exemption / NOA</label>
                            </fieldset>
                            <fieldset>
                                <h3>Fees</h3>
                                <input id="changingFees" type="checkbox" name="feesCompliance"/><label for="changingFees">Fees are indicative only.</label>
                                <br>
                                <input id="DTWDFees" type="checkbox" name="feesCompliance"/><label for="DTWDFees">DTWD VET Fees & Charges Policy.</label>
                                <br>
                                <input id="paymentPlans" type="checkbox" name="feesCompliance"/><label for="paymentPlans">Payment plans.</label>
                            </fieldset>
                        </div>
                    </div>
                </div>
                <div class="centered">
                    <br>
                    <button id="exportButton" onclick="pdfExport()" class="pure-button pure-button-primary">Export Flyer</button>
                    <p class="tinyText" style="color: red;">On print dialog, make sure to enable <strong>"Background Graphics"</strong> under <strong>"More Settings"</strong>.</p>
                </div>
            </div>
        </div>
    </div>
    <iframe id="exportFrame" style="display: none;">
    </iframe>
</body>

<style>
    /* Style Overrides */
    .page {
        margin: 1cm 0;
    }
</style>

<script>
//#region Classes:
class contact {
    constructor(firstname, lastname, email, phonenumber){
        this.firstname = firstname;
        this.lastname = lastname;
        this.email = email;
        this.phonenumber = phonenumber;
    }
}

class course{
    constructor(courseCode="", courseName="No course selected", courseInfo="", abv=false, mtacs=false, sst=false, jobRoles=[], imageName="", units=[]){
        this.courseCode = courseCode;
        this.courseName = courseName;
        this.courseInfo = courseInfo;
        this.abv = abv;
        this.mtacs = mtacs;
        this.sst = sst;
        this.jobRoles = jobRoles;
        this.imageName = imageName;
        this.units = units;
    }
}

class unit {
    constructor(unitCode="", unitName="", type=null){
        this.unitCode = unitCode;
        this.unitName = unitName;
        this.unitType = type;
    }
}

class flyer {
    constructor(rto, courseCode, contactPerson=new contact("John", "Smith", "jsmith@example.com", "0428 939 663"), courseObj= new course(), courseStart="", courseStartSubtext="", duration="", durationSubtext="", location="", locationSubtext="", normalFee=0, concessionFee=0, selectedUnits = [], selectedCompliance=[],selectedLogos=[true, true, true, true]){
        this.rto = rto;
        this.courseCode = courseCode;
        this.contact = contactPerson;
        this.courseObj = courseObj;
        this.courseStart = courseStart;
        this.courseStartSubtext = courseStartSubtext;
        this.duration = duration;
        this.durationSubtext = durationSubtext;
        this.location = location;
        this.locationSubtext = locationSubtext;
        this.normalFee = normalFee;
        this.concessionFee = concessionFee;
        this.selectedUnits = selectedUnits;
        this.selectedCompliance = selectedCompliance;
        this.selectedLogos = selectedLogos;
    }
}

contacts = [
        new contact("Kevin", "Kelly", "kkelly@trainingalliance.com.au", "0428 939 663"),
        new contact("Jennifer", "Congdon", "jcongdon@trainingalliance.com.au", "0488 550 484")
]

//Watch for updates to flyer:
const watcher = {
    set(obj, prop, value){
        Reflect.set(obj, prop, value); // Set requested value
        if (prop == "courseCode"){
            editingFlyer.courseObj = _getCourse(value);
        }
        else if (prop == "selectedUnits" && value == []){
            //Do nothing
        }
        else{
            updateFlyerPreview(editingFlyer); // Also call flyer update
        }
    }
}
//#endregion

var editingFlyer = new Proxy(new flyer("null", "Course Title"), watcher); //Global var, proxy waits for changes and updates flyer preview.

//Fetch courses and their units:
courses = undefined;
fetch("resources/dataResources/coursesAndUnits.json")
    .then(response => response.json())
    .then(data => courses = data.courses);

//#region Flyer Logic
function _getCourse(courseCode) { //Returns course object from the global list
    if (courses !== undefined){

        for (c of courses){
            if (c.courseCode == courseCode){
                return new course(c.courseCode, c.courseTitle, c.courseInfo,c.abv, c.mtacs, c.sst, c.jobRoles, c.imageName, c.units);
            }
        }
    }
    return new course("", "No course selected!");
}

function _getUnit(unitCode) {
    for (c of courses){
        for (u of c.units){
            if (u.unitCode == unitCode){
                return new unit(u.unitCode, u.unitTitle, u.type);
                break;
            }
        }
    }
    return new unit();
}

function _clearTable() {
    table = document.getElementById("unitTable");
    table.innerHTML = `
        <tr>
            <th style="width: 27%;">Unit Code</th>
            <th>Unit Title</th>
        </tr>
    `;
}

function detailsChange(element, propertyName) {

    editingFlyer[propertyName] = element.value;
}

function RTOSelect() {
    
    //Detect which input is currently selected:
    inputElements = document.getElementById("sidebarInputsRTO").getElementsByTagName("INPUT");
    for (var i = 0; i < inputElements.length; i ++){
        if (inputElements[i].checked){
            editingFlyer.rto = inputElements[i].id;
            console.log("Changed RTO to " + editingFlyer.rto);
            editingFlyer.courseCode = "";
            break;
        }
    }
}

function courseSelect() {
    
    //Get current RTO:
    rto = editingFlyer.rto;
    selector = undefined;

    if (rto == "abv"){
        selector = document.getElementById("abvCourses");
    }
    else if (rto == "mtacs"){
        selector = document.getElementById("mtacsCourses");
    }
    else {
        selector = document.getElementById("sstCourses");
    }

    //Change flyer course:
    editingFlyer.courseCode = selector.value;
    editingFlyer.selectedUnits = [];

    //Change stock image:
    stockImage = document.getElementById("stockImage");
    stockImage.src = `resources/images/stockImages/${editingFlyer.courseObj.imageName}`;

    //#region Update units section:
    //Select div:
    unitTable = document.getElementById("unitSelectorTable");
    unitTable.innerHTML=`
        <tr>
            <th></th>
            <th>Unit Code</th>
            <th>Unit Title</th>
        </tr>`;

    coreUnits = [];

    for (_unit of editingFlyer.courseObj.units){
        if (_unit.type == null || _unit.type == 'Elective' ){
            _row = unitTable.insertRow(-1);
            cell1 = _row.insertCell(0);
            cell2 = _row.insertCell(1);
            cell3 = _row.insertCell(2);

            cell1.innerHTML = "<input id='" + _unit.unitCode + "' type='checkbox' onchange='unitSelect()' name='unitSelection'/>";
            cell2.innerHTML = "<label for='" + _unit.unitCode + "'>" + _unit.unitCode + "</label>";
            cell3.innerHTML = "<label for='" + _unit.unitCode + "'>" + _unit.unitTitle + "</label>";
        }else{
            coreUnits.push(_unit);
        }
    }

    editingFlyer.selectedUnits = coreUnits;
    //#endregion


}

function unitSelect() {

    //Get ticked boxes:
    inputs = document.getElementById("unitSelectorTable").getElementsByTagName("INPUT");
    selectedUnits = []
    for (input of inputs){
        if (input.checked){
            //Get unit and push into array
            selectedUnits.push(_getUnit(input.id));
        }
    }

    //Core units
    coreUnits = editingFlyer.courseObj.units.filter(unit => unit.type == 'Core');
    editingFlyer.selectedUnits = selectedUnits.concat(coreUnits);
}

function contactSelect() {

    inputElements = document.getElementById("contactSelector").getElementsByTagName("INPUT");
    contactIndex = 0;

    for (i of inputElements){
        if (i.checked){
            contactIndex = parseInt(i.id.replace(/\D/g, ''));
            break;
        }
    }

    editingFlyer.contact = contacts[contactIndex];
}

function complianceLogoSelect() {

    inputElements = document.getElementById("complianceLogoSelector").getElementsByTagName("INPUT");
    logoArr = [true, true, true, true];
    for (i = 0; i < inputElements.length; i ++){
        ele = inputElements[i];
        logoArr[i] = ele.checked;
    }
    editingFlyer.selectedLogos = logoArr;
}

function complianceInfoSelect(){

    class complianceSnippet {
        constructor (element, text=""){
            this.inputElement = element;
            this.targetElement = undefined;
            this.selected = element.checked;
            this.text = text;
        }
    }

    otherInformationSection = document.getElementById("otherInfoContent");
    preReqsSection = document.getElementById("preReqsContent");
    eligibilitySection = document.getElementById("eligibilityCriteriaContent");
    pricingSection = document.getElementById("pricingInfoText");

    //#region Get elements:
    //Other information and Assessment methods:
    practicalTrainingLocation = new complianceSnippet(document.getElementById("practicalTrainingLocation"));
    practicalTrainingLocation.text = "Components of training may be conducted at a separate location. ";
    practicalTrainingLocation.targetElement = otherInformationSection;

    LLNStatement = new complianceSnippet(document.getElementById("LLNStatement"));
    LLNStatement.text = "All candidates must satisfactorily complete a language, literacy and numeracy support assessment (LLN) during the enrolment process. This will occur prior to course confirmation. ";
    LLNStatement.targetElement = otherInformationSection;

    studentAgreement = new complianceSnippet(document.getElementById("studentAgreement"));
    studentAgreement.text = "Students must read the Student Handbook and agree to the terms and conditions in it prior to enrolment. ";
    studentAgreement.targetElement = otherInformationSection;

    assessment = new complianceSnippet(document.getElementById("assessment"));
    assessment.text = "Assessments include written work and observation of practical skills. Alternative methods of assessment are based on reasonable adjustment. ";
    assessment.targetElement = otherInformationSection;

    usi = new complianceSnippet(document.getElementById("usi"));
    usi.text = "All students require a valid USI. ";
    usi.targetElement = otherInformationSection;

    completionDocs = new complianceSnippet(document.getElementById("completionDocs"));
    completionDocs.text = "A Certificate and Record of Result will be provided for all students who successfully complete all aspects of the course. A Statement of Attainment will be supplied for partial completion. ";
    completionDocs.targetElement = otherInformationSection;

    //Pre-reqs:
    adultCheck = new complianceSnippet(document.getElementById("adultCheck"));
    adultCheck.text = "Students must be 18yrs+ to undertake high-risk units. ";
    adultCheck.targetElement = preReqsSection;

    notAdult = new complianceSnippet(document.getElementById("notAdult"));
    notAdult.text = "In the case where a student cannot undertake high-risk units, substitute units will be implemented. "
    notAdult.targetElement = preReqsSection;

    //Eligibility Criteria:
    employmentStatus = new complianceSnippet(document.getElementById("employmentStatus"));
    employmentStatus.text = "Clients must be unemployed or under employed. ";
    employmentStatus.targetElement = eligibilitySection;

    citizenVisa = new complianceSnippet(document.getElementById("citizenVisa"));
    citizenVisa.text = "Clients must be an Australian citizen, permanent resident or holders of a sub-class 309, 444, 785, 790, 820 or 826 visa; secondary holders of a temporary visa of sub-class 457; and holders of a Bridging Visa E (subclasses 050 and 051) where the visa holder has made a valid application for a visa of subclass 785 or 790. ";
    citizenVisa.targetElement = eligibilitySection;

    schoolieCheck = new complianceSnippet(document.getElementById("schoolieCheck"));
    schoolieCheck.text = "Clients under the age of 18 who are mandatory high school age must have an accompanying NOA or have an exemption. ";
    schoolieCheck.targetElement = eligibilitySection;

    //Fees:
    changingFees = new complianceSnippet(document.getElementById("changingFees"));
    changingFees.text = "Student tutition fees are indicative only and are subject to change given individual circumstances at enrolment. Additional fees may apply such as Student service and resource fees. ";
    changingFees.targetElement = pricingSection;

    DTWDFees = new complianceSnippet(document.getElementById("DTWDFees"));
    DTWDFees.text = "All fees and charges are taken from the DTWD VET Fees and Charges Policy. ";
    DTWDFees.targetElement = pricingSection;

    paymentPlans = new complianceSnippet(document.getElementById("paymentPlans"));
    paymentPlans.text = "Payment plans are available for all courses, students who feel they are experiencing financial hardship should seek further advice from a training staff member. ";
    paymentPlans.targetElement = pricingSection;
    
    compiledArr = [practicalTrainingLocation, LLNStatement, studentAgreement, assessment, usi, completionDocs, adultCheck, notAdult, employmentStatus, citizenVisa, schoolieCheck, changingFees, DTWDFees, paymentPlans];

    editingFlyer.selectedCompliance = compiledArr.filter(object => object.inputElement.checked);
    //#endregion
}

function updateFlyerPreview() {
    
    //#region RTO:
    abvCourseSelector = document.getElementById("abvCourses");
    mtacsCourseSelector = document.getElementById("mtacsCourses");
    sstCourseSelector = document.getElementById("sstCourses");

    //RTO logos 1:
    abvLogo1 = document.getElementById("ABVLogo");
    mtacsLogo1 = document.getElementById("MTACSLogo");
    sstLogo1 = document.getElementById("SSTLogo");

    //RTO Logos 2:
    //abvLogo2 = document.getElementById("ABVLogo2");
    //mtacsLogo2 = document.getElementById("MTACSLogo2");
    //sstLogo2 = document.getElementById("SSTLogo2");

    //Page footer:
    rtoInfoElement = document.getElementById("RTOInfo");
    rtoInfoElement.innerHTML = ""; //Clear inner html

    //ABV:
    if (editingFlyer.rto == "abv"){

        //Courses:
        abvCourseSelector.classList.remove('hidden');
        mtacsCourseSelector.classList.add('hidden');
        sstCourseSelector.classList.add('hidden');

        //Logo 1
        abvLogo1.classList.remove('hidden');
        mtacsLogo1.classList.add('hidden');
        sstLogo1.classList.add('hidden');

        //Logo 2
        //abvLogo2.classList.remove('hidden');
        //mtacsLogo2.classList.add('hidden');
        //sstLogo2.classList.add('hidden');

        //Footer
        rtoInfoElement.innerHTML = `
            <p>Austrlian Business & Vocational Training</p>
            <p>RTO CODE: 52592</p>
            <p>ABN: 63 156 477 986</p>
            <p>PHONE: 08 6110 0800</p>`
        
    }
    //MTACS:
    else if (editingFlyer.rto == "mtacs"){

        abvCourseSelector.classList.add('hidden');
        mtacsCourseSelector.classList.remove('hidden');
        sstCourseSelector.classList.add('hidden');

        //Logo 1
        abvLogo1.classList.add('hidden');
        mtacsLogo1.classList.remove('hidden');
        sstLogo1.classList.add('hidden');

        //Logo 2
        //abvLogo2.classList.add('hidden');
        //mtacsLogo2.classList.remove('hidden');
        //sstLogo2.classList.add('hidden');

        rtoInfoElement.innerHTML = `
            <p>Mining, Transport & Construction Services</p>
            <p>RTO CODE: 52053</p>
            <p>ABN: 48 125 710 787</p>
            <p>PHONE: 08 6110 0800</p>`
    }
    //SST / default:
    else {

        abvCourseSelector.classList.add('hidden');
        mtacsCourseSelector.classList.add('hidden');
        sstCourseSelector.classList.remove('hidden');

        //Logo 1
        abvLogo1.classList.add('hidden');
        mtacsLogo1.classList.add('hidden');
        sstLogo1.classList.remove('hidden');

        //Logo 2
        //abvLogo2.classList.add('hidden');
        //mtacsLogo2.classList.add('hidden');
        //sstLogo2.classList.remove('hidden');

        rtoInfoElement.innerHTML = `
            <p>Stirling Skills Training</p>
            <p>RTO CODE: 5272</p>
            <p>ABN: 11 988 581 763</p>
            <p>PHONE: 08 6110 0800</p>`
    }
    //#endregion

    //#region Course:
    flyerHeader1 = document.getElementById("flyerHeader");
    flyerHeader2 = document.getElementById("secondaryFlyerHeader");

    flyerHeader1.innerHTML = editingFlyer.courseObj.courseCode + " " + editingFlyer.courseObj.courseName;
    flyerHeader2.innerHTML = flyerHeader1.innerHTML;

    //#region Course information:
    roleList = document.getElementById("jobRoleList");
    roleList.innerHTML = "";
    for (role of editingFlyer.courseObj.jobRoles){
        roleList.innerHTML += "<li>" + role + "</li>";
    }

    infoText = document.getElementById("infoText");
    infoText.innerHTML = editingFlyer.courseObj.courseInfo;

    //#endregion
    //#endregion

    //#region Units:
    _clearTable();
    table = document.getElementById("unitTable");

    for(u of editingFlyer.selectedUnits){
        row = table.insertRow();
        row.insertCell(0).innerHTML = u.unitCode;
        row.insertCell(1).innerHTML = u.unitName || u.unitTitle;
    }
    //#endregion

    //#region Details:
    document.getElementById("startDate").innerHTML = editingFlyer.courseStart;
    document.getElementById("startDateSubtext").innerHTML = editingFlyer.courseStartSubtext;

    document.getElementById("duration").innerHTML = editingFlyer.duration;
    document.getElementById("durationSubtext").innerHTML = editingFlyer.durationSubtext;

    document.getElementById("location").innerHTML = editingFlyer.location;
    document.getElementById("locationSubtext").innerHTML = editingFlyer.locationSubtext;

    document.getElementById("concessionPrice").innerHTML = "$" + editingFlyer.concessionFee;
    document.getElementById("price").innerHTML = "$" + editingFlyer.normalFee

    //#endregion

    //#region Contact:
    document.getElementById("contactName").innerHTML = editingFlyer.contact.firstname + " " + editingFlyer.contact.lastname;
    document.getElementById("contactEmail").innerHTML = editingFlyer.contact.email;
    document.getElementById("contactNumber").innerHTML = editingFlyer.contact.phonenumber;

    //#endregion

    //#region Compliance logos:
    logo1 = document.getElementById("jobSkillsLogo");
    logo2 = document.getElementById("skillsReadyLogo");
    logo3 = document.getElementById("LFLSLogo");
    logo4 = document.getElementById("NRTLogo");

    //Logo 1
    if (editingFlyer.selectedLogos[0]) logo1.classList.remove("hidden")
    else logo1.classList.add("hidden")

    //Logo 2
    if (editingFlyer.selectedLogos[1]) logo2.classList.remove("hidden")
    else logo2.classList.add("hidden")

    //Logo 3
    if (editingFlyer.selectedLogos[2]) logo3.classList.remove("hidden")
    else logo3.classList.add("hidden")

    //Logo 4
    if (editingFlyer.selectedLogos[3]) logo4.classList.remove("hidden")
    else logo4.classList.add("hidden")
    //#endregion

    //#region Compliance Text:
    otherInformationSection = document.getElementById("otherInfoContent");
    preReqsSection = document.getElementById("preReqsContent");
    eligibilitySection = document.getElementById("eligibilityCriteriaContent");
    pricingSection = document.getElementById("pricingInfoText");
    otherInformationSection.innerHTML = "";
    preReqsSection.innerHTML = "";
    eligibilitySection.innerHTML = "";
    pricingSection.innerHTML = "";

    complianceArr = editingFlyer.selectedCompliance;

    for (snippet of complianceArr){
        snippet.targetElement.innerHTML += snippet.text;
    }

    //Hide headers if there is no text in catagory:
    //Other info:
    parentElement = otherInformationSection.parentElement;
    if (otherInformationSection.innerHTML == ""){
        parentElement.classList.add("hidden");
    }
    else{
        parentElement.classList.remove("hidden");
    }

    //Pre-reqs
    parentElement = preReqsSection.parentElement;
    if (preReqsSection.innerHTML == ""){
        parentElement.classList.add("hidden");
    }
    else {
        parentElement.classList.remove("hidden");
    }

    //Eligibility 
    parentElement = eligibilitySection.parentElement;
    if (eligibilitySection.innerHTML == ""){
        parentElement.classList.add("hidden");
    } else {
        parentElement.classList.remove("hidden");
    }

    //Pricing
    if (pricingSection.innerHTML == ""){
        pricingSection.classList.add("hidden");
    } else {
        pricingSection.classList.remove("hidden");
    }

    //#endregion
}
//#endregion


//#region Sidebar
_setupSideContentToggles();
_populateContacts();
complianceInfoSelect();

//Browser warning:
if (is.not.chrome()) document.getElementById("browserWarning").classList.remove("hidden"); 

function _populateContacts (){

    contactContainer = document.getElementById("contactSelector");

    //Loop through contacts and each to html:
    for (let [index, c] of contacts.entries()){
        contactContainer.innerHTML += `
            <label for="contactCard` + index.toString() + `" class="contactCard">
                <input id="contactCard` + index.toString() + `" name="contacts" type="radio"/>
                <div>
                    <H4>` + c.firstname + ` ` + c.lastname + `</H4>
                    <p>` + c.email + `</p>
                    <p>` + c.phonenumber + `</p>
                </div>
            </label>
        `;
    }

    
}

function _setupSideContentToggles(){

    sections = document.getElementsByClassName("section");
    for (section of sections){ //Add listener to each section accordingly

        heading = section.getElementsByClassName("heading")[0];
        dropper = section.getElementsByClassName("dropper")[0];

        heading.addEventListener("click", function () {toggleSideContent.call(this)});
        dropper.addEventListener("click", function () {toggleSideContent.call(this)});

    }
}

function toggleSideContent(){
    //Get parent section:

    parent = this.parentElement;
    content = parent.getElementsByClassName("content")[0];
    img = parent.getElementsByTagName("IMG")[0];
    if (content.style.maxHeight) {
        content.style.maxHeight = null;
        img.src = "resources/images/down_arrow.png";
    }
    else {
        content.style.maxHeight = content.scrollHeight + "px";
        img.src = "resources/images/up_arrow.png";
    }
}

function checkScrollHeight() {
    content_elements = document.getElementsByClassName("content");
    for (content of content_elements){
        if (content.style.maxHeight) content.style.maxHeight = content.scrollHeight + "px";
    }
}
//#endregion
</script>